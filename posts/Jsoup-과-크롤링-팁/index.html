<!doctype html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Jsoup 과 크롤링 팁" /><meta name="author" content="이영수" /><meta property="og:locale" content="ko" /><meta name="description" content="크롤링은 Selenium 으로 하는거 아닌가요?" /><meta property="og:description" content="크롤링은 Selenium 으로 하는거 아닌가요?" /><link rel="canonical" href="https://youngsu5582.life//posts/Jsoup-%EA%B3%BC-%ED%81%AC%EB%A1%A4%EB%A7%81-%ED%8C%81/" /><meta property="og:url" content="https://youngsu5582.life//posts/Jsoup-%EA%B3%BC-%ED%81%AC%EB%A1%A4%EB%A7%81-%ED%8C%81/" /><meta property="og:site_name" content="{{ site.data.l10n.title }}" /><meta property="og:image" content="https://velog.velcdn.com/images/dragonsu/post/30e328a0-b078-4a23-be27-e540dad04d62/image.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-01-10T12:09:17+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://velog.velcdn.com/images/dragonsu/post/30e328a0-b078-4a23-be27-e540dad04d62/image.png" /><meta property="twitter:title" content="Jsoup 과 크롤링 팁" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"이영수"},"dateModified":"2025-01-10T12:09:17+09:00","datePublished":"2025-01-10T12:09:17+09:00","description":"크롤링은 Selenium 으로 하는거 아닌가요?","headline":"Jsoup 과 크롤링 팁","image":"https://velog.velcdn.com/images/dragonsu/post/30e328a0-b078-4a23-be27-e540dad04d62/image.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://youngsu5582.life//posts/Jsoup-%EA%B3%BC-%ED%81%AC%EB%A1%A4%EB%A7%81-%ED%8C%81/"},"url":"https://youngsu5582.life//posts/Jsoup-%EA%B3%BC-%ED%81%AC%EB%A1%A4%EB%A7%81-%ED%8C%81/"}</script><title>Jsoup 과 크롤링 팁 | {{ site.data.l10n.title }}</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="{{ site.data.l10n.title }}"><meta name="application-name" content="{{ site.data.l10n.title }}"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GDSPGC31HX"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-GDSPGC31HX'); }); </script><meta http-equiv="Content-Language" content="ko"><link rel="canonical" href="https://youngsu5582.life//posts/:title/"/><link rel="alternate" hreflang="ko" href="https://youngsu5582.life//posts/:title/"/><link rel="alternate" hreflang="x-default" href="https://youngsu5582.life//posts/:title/"/><link rel="alternate" hreflang="en" href="https://youngsu5582.life//en/posts/:title/"/><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">{{ site.data.l10n.title }}</a><p class="site-subtitle fst-italic mb-0">{{ site.data.l10n.tagline }}</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/articles/" class="nav-link"> <i class="fa-fw "></i> <span>ARTICLES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/youngsu5582" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['joyson5582','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/%EC%98%81%EC%88%98-%EC%9D%B4-b78498347/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="https://www.rallit.com/hub/resumes/988543/%EC%9D%B4%EC%98%81%EC%88%98" aria-label="resume" target="_blank" rel="noopener noreferrer" > <i class="fas fa-file-alt"></i> </a> <a href="https://comet-pram-809.notion.site/185365707b6580859ec5ec052f2f6730" aria-label="portfolio" target="_blank" rel="noopener noreferrer" > <i class="fas fa-laptop-code"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Jsoup 과 크롤링 팁</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="language-switcher-container"> <a href="#" class="lang-btn active">한국어</a><a href="/en/posts/Jsoup-%EA%B3%BC-%ED%81%AC%EB%A1%A4%EB%A7%81-%ED%8C%81/" class="lang-btn">English</a></div><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><div class="message-box" id="no-translation-msg"> 죄송합니다. 이 페이지는 한국어로 제공되지 않습니다.</div><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Jsoup 과 크롤링 팁</h1><p class="post-desc fw-light mb-4">크롤링은 Selenium 으로 하는거 아닌가요?</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1736478557" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 10, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://velog.velcdn.com/images/dragonsu/post/30e328a0-b078-4a23-be27-e540dad04d62/image.png" class="popup img-link preview-img shimmer"><img src="https://velog.velcdn.com/images/dragonsu/post/30e328a0-b078-4a23-be27-e540dad04d62/image.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3203 words" > <em>17 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Jsoup 과 크롤링 팁</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Jsoup 과 크롤링 팁</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog> <br><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/%EB%B0%B1%EC%97%94%EB%93%9C/">백엔드</a>, <a href="/categories/%EC%9E%90%EB%B0%94/">자바</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/jsoup/" class="post-tag no-text-decoration" >Jsoup</a> <a href="/tags/selenium/" class="post-tag no-text-decoration" >selenium</a> <a href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/" class="post-tag no-text-decoration" >우테코</a> <a href="/tags/%ED%81%AC%EB%A1%A4%EB%A7%81/" class="post-tag no-text-decoration" >크롤링</a></div><div class="content"><p>최근, 크롤링 작업을 하게 된 일이 있었다. 근데, <code class="language-plaintext highlighter-rouge">Selenium</code> 을 사용하지 않고 <code class="language-plaintext highlighter-rouge">Jsoup</code> 이라는 라이브러리를 사용하고 있어서 의아심이 있었다. 예전에 비트코인 매매봇, 수강 신청 매크로 등을 만들때 매번 셀레니움을 사용했기 때문이다.</p><h1 id="jsoup">Jsoup</h1><p>https://github.com/jhy/jsoup</p><p>Jsoup 은 HTML 과 XML 을 작업하게 해주는 라이브러리이다. DOM 에 관련된 API, CSS 및 XPath 를 사용해 선택할 수 있게 해준다.</p><h2 id="vs-selenium"><span class="me-2">VS Selenium</span><a href="#vs-selenium" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Jsoup 은 HTTP 요청을 날려서 가져온다. 즉, 서버로부터 응답받은 정적 HTML 데이터만 작업 가능하다는 의미다.</p><p>최신 웹사이트들은, 빠른 반응성을 위해 사용자가 콘텐츠를 서버에 요청했을 때 클라이언트 사이드 랜더링(CSR, Client-Side Rendering) 을 사용한다.</p><ol><li>서버는 데이터만 브라우저에 전송하고<li>브라우저에서는 이 데이터를 가지고 화면 랜더링</ol><p>CSR은 브라우저에서 화면을 그려준다는 동적인 특성 때문에 서버에 데이터를 요청하는 HTTP Request를 사용하면 실제 화면에 그려진 데이터는 수집할 수 없게 된다.</p><p>Selenium 은 WebDriver를 이용하므로 동적인 데이터들을 수집할 수 있다.</p><h3 id="webdriver"><span class="me-2">WebDriver</span><a href="#webdriver" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>브라우저를 프로그래밍적으로 제어할 수 있도록 설계된 자동화 인터페이스이다. ( 직접 열고,닫고,클릭, 네트워크 이벤트 등 제어 )</p><ul><li>브라우저 마다 각각의 Driver 를 가진다.<li>컴퓨터 내 존재하는 브라우저와 버전이 일치해야 한다.</ul><h3 id="사용해보기"><span class="me-2">사용해보기</span><a href="#사용해보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>단순, 성능 측정을 하려 했는데 매우 귀찮은 과정을 거쳤다. 설치하니 인식 못하고, 맥북이라 애플리케이션 지정했는데 안되고 등등등… ( 이 역시도 Selenium 의 단점 아닐까… )</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nc">WebDriverManager</span><span class="o">.</span><span class="na">chromedriver</span><span class="o">().</span><span class="na">setup</span><span class="o">();</span>  
<span class="kd">final</span> <span class="nc">WebDriver</span> <span class="n">driver</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ChromeDriver</span><span class="o">();</span>  

<span class="k">try</span> <span class="o">{</span>  
	<span class="n">driver</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"https://www.google.com/"</span><span class="o">);</span>  
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>  
	<span class="n">driver</span><span class="o">.</span><span class="na">quit</span><span class="o">();</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>설치되어 있는 Google Chrome 과 버전이 일치해야 하는데 이를 맞추기 어려울 수 있다. ( Driver 를 제공해주지 않거나, 버전 업데이트가 일어나거나 ) -&gt; 그렇기에, 버전을 자동으로 맞춰주는 <code class="language-plaintext highlighter-rouge">'io.github.bonigarcia:webdrivermanager:5.5.3'</code> 의존성을 사용했다.</p><p>버전이 있는지 확인하고, 없다면 자동으로 다운로드 + 경로 지정을 해준다. ( 로컬 캐시를 통해 반복적인 다운로드는 방지 )</p><p>이 부분 역시도 불필요한 시간을 소요한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">Setup</span> <span class="nc">Time</span> <span class="nl">Taken:</span> <span class="mi">347</span><span class="n">ms</span>
</pre></table></code></div></div><p>단순, <code class="language-plaintext highlighter-rouge">https://www.google.com/</code> 에 요청을 보내보면?</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="o">...</span>
<span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="nc">Jsoup</span><span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="n">url</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="n">driver</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
<span class="o">...</span>        
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nc">Jsoup</span> <span class="nc">Time</span> <span class="nl">Taken:</span> <span class="mi">795</span><span class="n">ms</span>

<span class="nc">Selenium</span> <span class="nc">Time</span> <span class="nl">Taken:</span> <span class="mi">1649</span><span class="n">ms</span>
</pre></table></code></div></div><p>이와같이 시간의 차이가 난다. <code class="language-plaintext highlighter-rouge">+</code> Chrome 을 실행시키는 것이므로 CPU 와 메모리가 더 소모가 된다. ( 확인할때는, 3MB 정도 발생 )</p><h3 id="결론"><span class="me-2">결론</span><a href="#결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Selenium 은 왠만하면 사용할 필요가 없다고 생각한다. ( 시간적인 면 + 리소스적인 면에서 성능적 차이가 나기 때문에 )</p><p>자기가 크롤링 해야하는게</p><ul><li>단계별 작업을 필요로 하는지 ( 로그인을 하고, 어떤 상호작용을 해야하며… )<li>정적인 데이터가 아닌, 동적인 데이터를 필요로 하는지</ul><p>가 아니라면, 정적 크롤링을 사용하도록 하자.</p><hr /><p>이제부터 Jsoup 을 사용하는 간단한 방법들과 팁을 정리하고 끝내겠다. 생각보다 <a href="https://jsoup.org/cookbook/">CookBook</a> 을 제공을 너무 잘해줘서 이 부분만 읽는다면 매우 편하게 작업할 수 있을 것이다.</p><h2 id="document-가져오기"><span class="me-2">Document 가져오기</span><a href="#document-가져오기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">Jsoup</span><span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="n">url</span><span class="o">)</span>
</pre></table></code></div></div><p>URL 을 통해 연결할 Connection 을 만든다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Connection</span> <span class="o">{</span>
	<span class="o">...</span>
<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Timeout</code>,<code class="language-plaintext highlighter-rouge">Header</code>,<code class="language-plaintext highlighter-rouge">Cookie</code> 등 우리가 흔히 아는 모든 HTTP 요소들을 가능하게 해준다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Override</span>  
<span class="kd">public</span> <span class="nc">Document</span> <span class="nf">get</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>  
    <span class="n">req</span><span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="nc">Method</span><span class="o">.</span><span class="na">GET</span><span class="o">);</span>  
    <span class="n">execute</span><span class="o">();</span>  
    <span class="nc">Validate</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">res</span><span class="o">);</span>  
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="na">parse</span><span class="o">();</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>이와같이 메소드를 호출하면 요청을 보내고, <code class="language-plaintext highlighter-rouge">Document</code> 를 받아온다.</p><p>이미 가져왔다면?</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">html</span> <span class="o">=</span> <span class="s">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Example&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;Hello, World!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">;</span>
<span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="nc">Jsoup</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">html</span><span class="o">);</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Jsoup.parse</code> 를 사용하면 된다.</p><h2 id="select"><span class="me-2">select</span><a href="#select" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://riverstone.co.kr/product/etro-%EC%97%90%ED%8A%B8%EB%A1%9C-%EC%9A%B8-%EB%B8%94%EB%A0%88%EC%9D%B4%EC%A0%80-%ED%8C%AC%EC%B8%A0-%EC%84%B8%ED%8A%B8-size-women-free-made-in-italy/87657/category/1/display/2/">예제 URL</a></p><p>와 같은 예시가 있을때?</p><p>개발자 도구를 통해 들어가서 <code class="language-plaintext highlighter-rouge">Elements</code> 부분이 우리가 사용할 수 있는 요소들이다. ( 물론, CSR 을 통해 생성된 동적인 요소들인지는 확인해야 한다. )</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">document</span><span class="o">.</span><span class="na">html</span><span class="o">()</span>
</pre></table></code></div></div><p>을 통해 확인가능하다.</p><p>Jsoup 은 CSS Selector 를 제공해주기 때문에 이를 사용해 DOM 의 요소들을 매우 편리하게 추출할 수 있다.</p><ul><li>기본 선택자 ( <code class="language-plaintext highlighter-rouge">tag</code>, <code class="language-plaintext highlighter-rouge">.class</code>, <code class="language-plaintext highlighter-rouge">#id</code> )<li>계층 선택자<li>속성 선택자<li>상태 선택자 ( Jsoup 이 지원해주는 요소 ) - <code class="language-plaintext highlighter-rouge">div:contains(Hello)</code></ul><blockquote><p>계층 선택자에서 흔히 실수하는 요소가 있는데</p><ul><li>ancestor descendant : 특정 조상의 모든 자손 선택<li>parent &gt; child : 특정 부모의 바로 아래 자식 선택 이 두개의 차이점을 주의해야 한다.</ul></blockquote><p>HTML 문서들은 트리 구조로 표현이 된다. ( 각 태그가 트리의 노드로 변환 )</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">Elements</span> <span class="nf">select</span><span class="o">(</span><span class="nc">Evaluator</span> <span class="n">evaluator</span><span class="o">,</span> <span class="nc">Element</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">return</span> <span class="nc">Collector</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">evaluator</span><span class="o">,</span> <span class="n">root</span><span class="o">);</span>  
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Elements</span> <span class="nf">collect</span> <span class="o">(</span><span class="nc">Evaluator</span> <span class="n">eval</span><span class="o">,</span> <span class="nc">Element</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>  
    <span class="n">eval</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>  
  
    <span class="k">return</span> <span class="n">root</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>  
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">eval</span><span class="o">.</span><span class="na">asPredicate</span><span class="o">(</span><span class="n">root</span><span class="o">))</span>  
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">Elements:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>  
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">Predicate</span><span class="o">&lt;</span><span class="nc">Element</span><span class="o">&gt;</span> <span class="nf">asPredicate</span><span class="o">(</span><span class="nc">Element</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">return</span> <span class="n">element</span> <span class="o">-&gt;</span> <span class="n">matches</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">element</span><span class="o">);</span>  
<span class="o">}</span>

<span class="c1">// 이는 구현체 ( 매 요소마다 다름 )</span>

<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">Element</span> <span class="n">root</span><span class="o">,</span> <span class="nc">Element</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="na">hasAttr</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="n">key</span><span class="o">).</span><span class="na">trim</span><span class="o">());</span>  
<span class="o">}</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">&lt;meta property="product:sale_price:amount" content="84000"&gt;</code> 가 있으면?</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">element</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">selectFirst</span><span class="o">(</span><span class="s">"meta[property='product:sale_price:amount']"</span><span class="o">)</span>  
<span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">"content"</span><span class="o">)</span> <span class="c1">// 84000</span>
</pre></table></code></div></div><p>를 통해 <code class="language-plaintext highlighter-rouge">meta property</code> 를 찾고, 그 내부 요소를 추출한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">"div.xans-product-additional #prdDetail img"</span><span class="o">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">div</code> 중 <code class="language-plaintext highlighter-rouge">xans-product-additional</code> 클래스를 가지는 -&gt; <code class="language-plaintext highlighter-rouge">prdDetail</code> 라는 ID 를 가지는 요소의 모든 자손 중 <code class="language-plaintext highlighter-rouge">img</code> 들만 추출한다.</p><h2 id="간단한-팁"><span class="me-2">간단한 팁</span><a href="#간단한-팁" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="최대한-단순하게"><span class="me-2">최대한 단순하게</span><a href="#최대한-단순하게" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://i.imgur.com/GPsNZuh.png" class="popup img-link shimmer"><img src="https://i.imgur.com/GPsNZuh.png" alt="" loading="lazy"></a></p><p><a href="https://riverstone.co.kr/product/indivi-%EC%95%99%EA%B3%A0%EB%9D%BC-%EC%9A%B8-%EC%9E%90%EC%BC%93-size-women-free/87479/category/25/display/1/">샘플 링크</a></p><p>해당 링크에서 상세내용이 필요해 Selector 를 복사해보면? -&gt; <code class="language-plaintext highlighter-rouge">#infoArea_fixed &gt; div.xans-element-.xans-product.xans-product-detaildesign &gt; table</code> 가 나온다.</p><p><code class="language-plaintext highlighter-rouge">document.select("#infoArea_fixed &gt; div.xans-element-.xans-product.xans-product-detaildesign &gt; table &gt; tbody")</code></p><p>를 통해서 가져올 수 있지만, <code class="language-plaintext highlighter-rouge">.xans-product &gt; table &gt; tbody</code> 로도 가능하다. 두 개의 성능 차이는?</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>  
  
        <span class="nc">TimeUtil</span><span class="o">.</span><span class="na">measureExecutionTime</span><span class="o">(</span><span class="s">"jsoup deep"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>  
            <span class="kd">final</span> <span class="kt">var</span> <span class="n">baseUrl</span> <span class="o">=</span> <span class="s">"https://riverstone.co.kr"</span><span class="o">;</span>  
            <span class="kd">final</span> <span class="kt">var</span> <span class="n">document</span> <span class="o">=</span> <span class="n">getDocument</span><span class="o">(</span><span class="s">"https://riverstone.co.kr/category/women/25/?page=3"</span><span class="o">);</span>  
  
            <span class="kd">final</span> <span class="kt">var</span> <span class="n">documents</span> <span class="o">=</span> <span class="n">parseDocument</span><span class="o">(</span><span class="n">document</span><span class="o">,</span> <span class="s">"ul.prdList a"</span><span class="o">)</span>  
                    <span class="o">.</span><span class="na">stream</span><span class="o">()</span>  
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">element</span> <span class="o">-&gt;</span> <span class="n">element</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">"href"</span><span class="o">))</span>  
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">url</span> <span class="o">-&gt;</span> <span class="n">getDocument</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">baseUrl</span><span class="o">))</span>  
                    <span class="o">.</span><span class="na">toList</span><span class="o">();</span>  
  
            <span class="kd">final</span> <span class="kt">var</span> <span class="n">result1</span> <span class="o">=</span> <span class="n">findFirst</span><span class="o">(</span><span class="n">documents</span><span class="o">);</span>  
<span class="c1">//            final var result2 = findSecond(documents);  </span>
        <span class="o">});</span>  
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">findFirst</span><span class="o">(</span><span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Document</span><span class="o">&gt;</span> <span class="n">documents</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">return</span> <span class="n">documents</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>  
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">document</span> <span class="o">-&gt;</span> <span class="n">document</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">".xans-product &gt; table &gt; tbody"</span><span class="o">))</span>  
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">element</span> <span class="o">-&gt;</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">element</span><span class="o">)</span>  
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Elements:</span><span class="o">:</span><span class="n">text</span><span class="o">)</span>  
                    <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>  
            <span class="o">.</span><span class="na">toList</span><span class="o">();</span>  
<span class="o">}</span>  
  
<span class="kd">private</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">findSecond</span><span class="o">(</span><span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Document</span><span class="o">&gt;</span> <span class="n">documents</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">return</span> <span class="n">documents</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>  
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">document</span> <span class="o">-&gt;</span> <span class="n">document</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">"#infoArea_fixed &gt; div.xans-element-.xans-product.xans-product-detaildesign &gt; table &gt; tbody"</span><span class="o">))</span>  
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">element</span> <span class="o">-&gt;</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">element</span><span class="o">)</span>  
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Elements:</span><span class="o">:</span><span class="n">text</span><span class="o">)</span>  
                    <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>  
            <span class="o">.</span><span class="na">toList</span><span class="o">();</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>캐싱 및 추가적인 요소들을 피하기 위해 의도적으로 페이지네이션을 통해 가져오게 했다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// .xans-product &gt; table &gt; tbody - 51291ms  </span>
<span class="c1">// #infoArea_fixed &gt; div.xans-element-.xans-product.xans-product-detaildesign &gt; table &gt; tbody - 50122ms</span>
</pre></table></code></div></div><p>놀랍게도 큰 차이가 없다. 이는 DOM 트리 탐색 방식 때문이다. 해당 내용은 자세히는 다루지 않는다. ( 주제에 벗어난 부분 ) <a href="https://ko.javascript.info/document">모던 JavaScript 문서</a> 해당 부분을 더 참고하면 좋을거 같다.</p><ul><li>DOM 은 트리 형태 계층적, 요소를 찾기 위해 계층을 따라 위 아래 이동 가능하다. - 관련 없는 부분 검색할 필요 없음.<li>고유 ID 를 기반으로 요소를 빠르게 찾도록 최적화 - HashMap 과 유사하게 O(1) 기대<li>브라우저가 잘못된 <code class="language-plaintext highlighter-rouge">html</code> 들은 DOM 탐색 및 조작을 효율적으로 처리하기 위해 자동으로 교정해준다.</ul><p>이런 요소들을 기반으로 시간의 차이가 없게 만든다.</p><p>그럼에도, 필요한 요소들만 적용해서 크롤링을 해야 한다. 자세하게 나타낼수록, 변경에 민감해진다.</p><ul><li><p><code class="language-plaintext highlighter-rouge">#infoArea_fixed</code> 가 <code class="language-plaintext highlighter-rouge">#infoArea</code> 로 변경이 된다면? -&gt; 해당 크롤링은 변경이 되어야 한다.</p><li><p><code class="language-plaintext highlighter-rouge">div.xans-element-.xans-product.xans-product-detaildesign</code> 중 <code class="language-plaintext highlighter-rouge">xans-product-detaildesign</code> 이 필요가 없어진다면? -&gt; 해당 크롤링은 변경이 되어야 한다.</p></ul><p>브라우저가 자동으로 제공해주는 <code class="language-plaintext highlighter-rouge">Selector</code> 가 아니라 자신이 직접 검색해서 필요한 요소들만 구성을 하자.</p><blockquote><p>특히, 단순 <code class="language-plaintext highlighter-rouge">Copy Selector</code> 를 하면 <code class="language-plaintext highlighter-rouge">#prdDetail &gt; div &gt; div &gt; div &gt; div &gt; div &gt; img:nth-child(1)</code> 이와 같이 요소들의 모든 선택자들을 가져오는 경우가 있다. 이때, <code class="language-plaintext highlighter-rouge">div &gt; ... &gt; div</code> 는 필요없을 수 있다. 어차피, <code class="language-plaintext highlighter-rouge">#prdDetail</code> 내 <code class="language-plaintext highlighter-rouge">img</code> 들을 가져오게 하는게 핵심이므로</p></blockquote><h3 id="변하지-않게"><span class="me-2">변하지 않게</span><a href="#변하지-않게" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://deadstock.co.kr/product/adidas-%EC%95%84%EB%94%94%EB%8B%A4%EC%8A%A4-%ED%8F%B4%EB%A6%AC%EC%97%90%EC%8A%A4%ED%84%B0-100-%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%8B%9D-%ED%8C%AC%EC%B8%A0-%EC%97%AC-l/450317/category/775/display/1/">샘플 링크</a></p><p><a href="https://i.imgur.com/hRD0ThX.png" class="popup img-link shimmer"><img src="https://i.imgur.com/hRD0ThX.png" alt="" loading="lazy"></a></p><p>썸네일용 사진을 가져오려고 하면?</p><p><code class="language-plaintext highlighter-rouge">#prdDetail &gt; img:nth-child(1)</code> 와 같이 가져온다.</p><p><code class="language-plaintext highlighter-rouge">nth-child</code> 는 매우 가변적인 요소이다. <code class="language-plaintext highlighter-rouge">img 중 n번째 자식</code> 라는 의미이기 때문이다. 이 역시도, DOM 의 구조가 변하거나 웹 사이트 개발자들이 이미지 순서를 변경하면 침범을 받는다.</p><p>대부분의 상품성 사이트들은 검색 엔진 최적화를 위해 다양한 요소들을 제공한다.</p><p><a href="https://i.imgur.com/WAfiY5x.png" class="popup img-link shimmer"><img src="https://i.imgur.com/WAfiY5x.png" alt="" loading="lazy"></a></p><ul><li>descritpion,keywords,author<li>og:title,og:type,og:url ( Open Graph Protocol )<li>naver,google site vertification</ul><p><code class="language-plaintext highlighter-rouge">meta</code> 를 통해 검색하거나, <code class="language-plaintext highlighter-rouge">head</code> 부분에 보면 매우 다양한 정보들을 제공해준다. 우리가 사용하려는 썸네일은? <code class="language-plaintext highlighter-rouge">og:image</code> 를 통해서도 같은 사진이 제공이 된다.</p><p><code class="language-plaintext highlighter-rouge">본문 내용에서 추출하는 것</code> 보다 <code class="language-plaintext highlighter-rouge">검색 엔진을 위해 제공해주는 것</code> 이 더 변하지 않고, 항상 제공될 거라 기대할 수 있다.</p><p>이와 같은 맥락으로 자신이 지금 크롤링 하는 부분이 얼마나 변화에 민감할지, 고정으로 제공해줄지 등을 판단하는 것 역시도 매우 좋은 요소가 될 것이다.</p><h3 id="당연한-robots"><span class="me-2">당연한 robots</span><a href="#당연한-robots" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>너무나 당연하지만 <code class="language-plaintext highlighter-rouge">robots.txt</code> 는 항상 잘 살펴보자. 웹 크롤러에게 특정 부분에 대한 접근을 허용하거나 차단하는 지침을 제공해준다.</p><ul><li>특정 크롤러 ( <code class="language-plaintext highlighter-rouge">User-Agent</code> ) 를 차단하게 해주거나 - Github 는 User-Agent 를 비운채 요청을 보내면 <code class="language-plaintext highlighter-rouge">4xx</code> 를 던진다.<li>특정 경로를 접근하지 못하게 하거나 - <code class="language-plaintext highlighter-rouge">/admin, /api</code><li>SEO 가 불필요한 접근을 하지 않거나</ul><p>의 요소들로 이루어진다.</p><p>특히, 허용하지 않는 요소들을 무분별하게 크롤링해 상업적 이용을 하면 처벌이 될수도 있다. <a href="https://www.hani.co.kr/arti/society/society_general/1061963.html">### 형사는 무죄, 민사는 “10억 배상”…데이터 크롤링 어디까지 되나</a> ( 유명한 야놀자 vs 여기어때의 크롤링 법적 공방 )</p><h3 id="함수화"><span class="me-2">함수화</span><a href="#함수화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이건 크롤링보다 사소한 꿀팁이지만</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nd">@Component</span>  
<span class="kd">class</span> <span class="nc">ThumbnailImageInMeta</span> <span class="p">:</span> <span class="nc">ThumbnailImage</span> <span class="p">{</span>  
  
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">parseFrom</span><span class="p">(</span><span class="n">document</span><span class="p">:</span> <span class="nc">Document</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">String</span> <span class="p">{</span>  
        <span class="kd">val</span> <span class="py">element</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">selectFirst</span><span class="p">(</span><span class="s">"meta[property='og:image']"</span><span class="p">)</span>  
        <span class="k">return</span> <span class="n">element</span><span class="o">?.</span><span class="nf">attr</span><span class="p">(</span><span class="s">"content"</span><span class="p">)</span><span class="o">?:</span><span class="k">throw</span> <span class="nc">IllegalStateException</span><span class="p">(</span><span class="s">"Not Exist ThumbnailImage In Meta"</span><span class="p">)</span>  
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>자주 사용한다면, <code class="language-plaintext highlighter-rouge">@Component</code> 화 해서 이를 주입해서 사용을 하게하자. 이는 크롤링 하려는 요소의 성격에 따라 다르지만, 비슷한 양상을 가진다면 선언하고 주입을 받아 코드 중복을 방지하자.</p><p>어차피, 크롤링은 기존 서버와 분리된 경우가 많으며 + 정해진 시간 or 규칙적으로 되는 경우가 많다. ( 메모리 및 성능에도 크게 구애 받지 않는다. )</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="kd">val</span> <span class="py">crawler</span> <span class="p">=</span> <span class="nc">Crawler</span><span class="p">(</span>  
    <span class="nc">ThumbnailImageInMeta</span><span class="p">(),</span>
<span class="p">)</span>
</pre></table></code></div></div><p>와 같이 단위 테스트를 할때는? -&gt; 그냥 생성을 할 수 있으므로 Spring 의존성을 벗어나도 상관없다.</p><p>물론, 성급하게 코드를 추상화 및 공통화 하지 말고 적절히 된다면 도입하자.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">abstract</span> <span class="kd">class</span> <span class="nc">Cafe24Crawler</span><span class="p">(</span>
	<span class="o">..</span><span class="p">.</span>
<span class="p">)</span>
<span class="kd">class</span> <span class="nc">SampleCrawler</span><span class="p">():</span><span class="nc">Cafe24Crawler</span>
</pre></table></code></div></div><p>이런식의 <code class="language-plaintext highlighter-rouge">추상 클래스</code> : <code class="language-plaintext highlighter-rouge">구현 클래스</code> 로 코드 중복 감소 역시도 가능하다.</p><h2 id="결론-1"><span class="me-2">결론</span><a href="#결론-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>크롤링도 최대한 빠르고,쉽게 접근해 구현하면 가능하다.</p><p>하지만</p><ul><li>크롤링적으로도 변경에 민감하지 않게<li>코드적으로 변경에 민감하지 않게</ul><p>이 두가지를 잘 생각해서 크롤링을 만들어나가자.</p></div><div class="post-tail-wrapper text-muted"><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Jsoup%20%EA%B3%BC%20%ED%81%AC%EB%A1%A4%EB%A7%81%20%ED%8C%81%20-%20%7B%7B%20site.data.l10n.title%20%7D%7D&url=https%3A%2F%2Fyoungsu5582.life%2F%2Fposts%2FJsoup-%25EA%25B3%25BC-%25ED%2581%25AC%25EB%25A1%25A4%25EB%25A7%2581-%25ED%258C%2581%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyoungsu5582.life%2F%2Fposts%2FJsoup-%25EA%25B3%25BC-%25ED%2581%25AC%25EB%25A1%25A4%25EB%25A7%2581-%25ED%258C%2581%2F&text=Jsoup%20%EA%B3%BC%20%ED%81%AC%EB%A1%A4%EB%A7%81%20%ED%8C%81%20-%20%7B%7B%20site.data.l10n.title%20%7D%7D" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fyoungsu5582.life%2F%2Fposts%2FJsoup-%25EA%25B3%25BC-%25ED%2581%25AC%25EB%25A1%25A4%25EB%25A7%2581-%25ED%258C%2581%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-Jackson-%EC%84%A4%EC%A0%95%EB%93%A4-%EC%A0%95%EB%A6%AC/">사용하는 Jackson의 설정 및 기능 정리 - 2025-06-17</a><li class="text-truncate lh-lg"> <a href="/posts/%EC%98%88%EC%99%B8-%EA%B9%8A%EA%B2%8C-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0-%EC%98%88%EC%99%B8-%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%8D%98%EC%A7%80%EA%B8%B0/">예외 깊게 살펴보기, 예외 동적으로 던지기 - 2025-05-31</a><li class="text-truncate lh-lg"> <a href="/posts/%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-ENUM-%EA%B0%92-%EB%8C%80%EC%9D%91,Interface-%ED%86%B5%ED%95%9C-%EC%A4%91%EB%B3%B5-%EC%BD%94%EB%93%9C-%EC%A0%9C%EA%B1%B0/">사용하지 않는 ENUM 값 대응 , Interface 를 통한 중복 코드 제거 - 2025-05-26</a><li class="text-truncate lh-lg"> <a href="/posts/oom-killer,-heap-memory,-heapdump/">oom killer, heap memory, heapdump - 2025-04-20</a><li class="text-truncate lh-lg"> <a href="/posts/%EB%8F%88%EC%9C%BC%EB%A1%9C-%EC%8B%9C%EA%B0%84-%EC%82%AC%EA%B8%B0/">돈으로 시간을 사기 - 부제 : openai 통한 게시글 소개글 및 섬네일 자동 생성 스크립트 - 2025-03-22</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/">우테코</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%8A%A4%ED%94%84%EB%A7%81/">스프링</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%9A%8C%EA%B3%A0/">회고</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B9%83%ED%97%88%EB%B8%8C/">깃허브</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B9%83/">깃</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%ED%8B%80%EB%A6%B0/">코틀린</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%85%8C%EC%8A%A4%ED%8A%B8/">테스트</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/%EC%8A%A4%EB%A0%88%EB%93%9C%EC%8A%A4%EB%A0%88%EB%93%9C%ED%92%80-in-Java/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1737082973" data-df="ll" > Jan 17, 2025 </time><h4 class="pt-0 my-2">스레드,스레드풀 in Java</h4><div class="text-muted"><p>왜 여러개의 스레드 풀이 하나의 스레드 풀보다 좋은가</p></div></div></a></article><article class="col"> <a href="/posts/%EC%95%8C%EC%95%84%EB%8F%84-%EC%A0%95%EB%A7%90-%EC%93%B8%EB%8D%B0%EC%97%86%EB%8A%94-%EC%9E%90%EB%B0%94-%EC%9E%A1%ED%95%99%EC%82%AC%EC%A0%84-with-JOL/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1732082090" data-df="ll" > Nov 20, 2024 </time><h4 class="pt-0 my-2">알아도 정말 쓸데없는 자바 잡학사전 with JOL</h4><div class="text-muted"><p>알아도 하나도 정말 쓸데없음 주의</p></div></div></a></article><article class="col"> <a href="/posts/%EC%9E%90%EB%B0%94-%EB%A6%AC%ED%94%8C%EB%A0%89%EC%85%98-%EC%96%B4%EB%94%94-%EA%B9%8C%EC%A7%80-%EA%B0%80%EB%8A%A5%ED%95%A0%EA%B9%8C/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1723734765" data-df="ll" > Aug 16, 2024 </time><h4 class="pt-0 my-2">자바 리플렉션 어디 까지 가능할까</h4><div class="text-muted"><p>PR 올리기 전 내 모든 메소드가 쿼리를 몇 번 실행 하는지 검사 & 리포트를 가능하게</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/2024-%ED%9A%8C%EA%B3%A0-%EC%9A%B0%ED%85%8C%EC%BD%94%EB%A5%BC-%EB%A7%88%EB%AC%B4%EB%A6%AC%ED%95%98%EB%A9%B0/" class="btn btn-outline-primary" aria-label="Older" ><p>2024 회고 ( 우테코를 마무리하며 )</p></a> <a href="/posts/%EC%8A%A4%EB%A0%88%EB%93%9C%EC%8A%A4%EB%A0%88%EB%93%9C%ED%92%80-in-Java/" class="btn btn-outline-primary" aria-label="Newer" ><p>스레드,스레드풀 in Java</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/youngsu5582">이영수</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9A%B0%ED%85%8C%EC%BD%94/">우테코</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%8A%A4%ED%94%84%EB%A7%81/">스프링</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%9A%8C%EA%B3%A0/">회고</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B9%83%ED%97%88%EB%B8%8C/">깃허브</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B9%83/">깃</a> <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%ED%8B%80%EB%A6%B0/">코틀린</a> <a class="post-tag btn btn-outline-primary" href="/tags/%ED%85%8C%EC%8A%A4%ED%8A%B8/">테스트</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'youngsu5582/blog', 'data-repo-id': 'R_kgDOOI2eig', 'data-category': 'Post', 'data-category-id': 'DIC_kwDOOI2eis4Cob3Y', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
